---
layout: page
title: Password
permalink: /password/
---
<link href="/assets/bootstrap-3.3.6/dist/css/bootstrap.min.css" rel="stylesheet">

<script src="/assets/jquery-2.2.4.min.js"></script>
<script src="/assets/crypto-js-3.1.6/crypto-js.js"></script>
<script src="/assets/js/biginteger.js"></script>
<script>
var repeatString = function(str, times){
  return new Array(times + 1).join(str)
}

var shaConst = repeatString('abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789', 1000);
var changeBigIntBase = function(num, base_arr){
    var zero = BigInteger.ZERO;
    var divisor = BigInteger(base_arr.length)
    var result = '';
    while(num.compare(zero) !== 0){
        var divisionResult = num.divRem(divisor);
        var divide = divisionResult[0];
        var rem = divisionResult[1];
        result = base_arr[rem] + result;
        num = divide;
    }
    return result;
}

var getBaseArrayConstants = function(){
    var numbers = [];
    for(var i = 0; i < 10; i++)
        numbers.push(i.toString());
    var special = [];
    for(var i = 33; i < 127; i++)
        special.push(String.fromCharCode(i));
    var alphaNum = [];
    for(var i = 48; i <= 57; i++)
        alphaNum.push(String.fromCharCode(i));
    for(var i = 65; i <= 90; i++)
        alphaNum.push(String.fromCharCode(i));
    for(var i = 97; i <= 122; i++)
        alphaNum.push(String.fromCharCode(i));
    return {'numbers':numbers, 'special':special, 'alphaNum':alphaNum};
}

var baseArrayConstants = getBaseArrayConstants();

var computeSHA512 = function(id, password){
  var toHash = shaConst + id + password;
  return CryptoJS.SHA512(toHash).toString();
}

var computePassword = function(){
  var getText = function(idParam){
    return $('#' + idParam).val();
  }

  var id = getText('passwordIdentifier');
  var master1 = getText('master1');
  var master2 = getText('master2');
  var length = getText('pass_length');

  if (master1 !== master2){
    alert('Master password does not match.');
  }
  else{
      var passType = $('#pass_type').val();
      var shaHash = computeSHA512(id, master1, length);
      var shaNum = BigInteger('0x' + shaHash);
      if (passType === 'spec'){
          shaHash = changeBigIntBase(shaNum, baseArrayConstants.special);
      }
      else if (passType === 'number'){
          shaHash = changeBigIntBase(shaNum, baseArrayConstants.numbers);
      }
      else if (passType === 'alpha'){
          shaHash = changeBigIntBase(shaNum, baseArrayConstants.alphaNum);
      }
      var passText = shaHash.substring(0, parseInt($('#pass_length').val()));
      var myResult = $('#myResult')
      myResult.attr('value', passText);
      myResult.attr('size', passText.length);
  }

  return false;
}
</script>

<div class="container-fluid">
<div class="row">
    <div class="col-xs-12">
        <h1>Password Generator</h1>
    </div>
</div>
  <form onsubmit="return computePassword();" class="form">
    <div class="form-group">
        <h4>Identifier</h4>
        <input type="text" id="passwordIdentifier" class="form-control" placeholder="Identifier" required autofocus>
    </div>
    <div class="form-group">
        <h4>Password</h4>
        <input type="password" id="master1" class="form-control" placeholder="Master password" required>
    </div>
    <div class="form-group">
        <h4>Repeat</h4>
        <input type="password" id="master2" class="form-control" placeholder="Repeat master password" required>
    </div>
    <div class="form-group">
        <h4>Length:</h4>
        <input id="pass_length" type="number" min="1" value="128" class="form-control" value="128" required>
    </div>
    <div class="form-group">
        <h4>Password type:</h4>
        <select id="pass_type">
            <option value="spec">Special characters</option>
            <option value="alpha">Alphanumeric</option>
            <option value="number">Numbers</option>
            <option value="hex">Hex</option>
        </select>
    </div>
    <div class="form-group">
        <button class="btn btn-lg btn-primary btn-block" type="submit">Compute password</button>
    </div>
  </form>
  <div class="row">
      <div class="col-xs-12">
    <p>Password:</p>
    <p><input id="myResult" type="text" readonly="readonly"></p>
    </div>
  </div>
</div>
